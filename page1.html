<html>

<head>
	<link href="design.css" rel="stylesheet" type="text/css" />
		

<SCRIPT LANGUAGE="JavaScript">

// Below function will  
function init(){

	alert ("1");
	var xmlDoc=new ActiveXObject("MSXML.DOMDocument");
	alert ("after");
	xmlDoc.async="false";

	document.getElementById("link3").innerHTML="Shashi";


	xmlDoc.load("BusinessRequirements.xml");

	var rootNode=xmlDoc.documentElement;
   
 // we have Hard codded the value because we know that the "BusinessRequirements" tag is in child 1

	//alert ("before rootnode"+rootNode.childNodes[0].nodeValue);
	var nodes=rootNode.childNodes(0);
	
 	var i=0;
 	for(  i=0; i<nodes.childNodes.length; i++){
	 
	 //alert(nodes.childNodes(i).tagName);
		 if(nodes.childNodes(i).tagName=="my:DetailedRequirements"){ // should point to 1st level node
			 nodes=nodes.childNodes(i);
			 /*
				document.write('<table border="1" width="95%"> <tr align="center" bgcolor="#e8e8e8"><td><b>Business Requirements</b></tr></td> ');
				*/
			 getNodeXML(nodes);
				/*
			 document.write('</table> ');
				*/
			 break;	
		 } 
   }// For loop ends

	
} // Function ends


// Recursive function
function getNodeXML(tree){ 

 	if(tree.hasChildNodes()) {
		 
		for(var i=0; i<tree.childNodes.length; i++){
			getNodeXML(tree.childNodes(i));
	   }
	}else{
//	alert(  tree.nodeType+ "----------"+ tree.text);
    	if(tree.nodeType==3){
	    	document.write('<tr><td>'+tree.text+'</tr></td>'); 
				document.getElementById("link3").innerHTML = document.getElementById("link3").innerHTML+tree.text;
		}
	}
 }// recursive function ends 
 
  </SCRIPT>


</head>



<body>
<h1>My Homepage</h1>
<ol id="toc">
    <li class="current"><a href="page1.html">Page 1</a></li>
    <li><a href="page2.html">Page 2</a></li>
    <li><a href="page3.html">Page 3</a></li>
</ol>
<div class="content">
    <h2>Page 1</h2>
    <p>Text...</p>


		<input type="text" id="mybox" width="80"> </text>

		<a id="link3" href="javascript:init()">  Click me </a>



</div>
</body>
</html>
